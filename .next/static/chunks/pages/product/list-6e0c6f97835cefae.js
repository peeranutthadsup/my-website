(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[94],{8102:function(e,t,n){var s,a;void 0!==(a="function"==typeof(s=function(){"use strict";function t(e,t,n){var s=new XMLHttpRequest;s.open("GET",e),s.responseType="blob",s.onload=function(){o(s.response,t,n)},s.onerror=function(){console.error("could not download file")},s.send()}function s(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch(e){}return 200<=t.status&&299>=t.status}function a(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(n){var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var r="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof n.g&&n.g.global===n.g?n.g:void 0,c=r.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),o=r.saveAs||("object"!=typeof window||window!==r?function(){}:"download"in HTMLAnchorElement.prototype&&!c?function(e,n,c){var o=r.URL||r.webkitURL,i=document.createElement("a");n=n||e.name||"download",i.download=n,i.rel="noopener","string"==typeof e?(i.href=e,i.origin===location.origin?a(i):s(i.href)?t(e,n,c):a(i,i.target="_blank")):(i.href=o.createObjectURL(e),setTimeout(function(){o.revokeObjectURL(i.href)},4e4),setTimeout(function(){a(i)},0))}:"msSaveOrOpenBlob"in navigator?function(e,n,r){if(n=n||e.name||"download","string"!=typeof e){var c;navigator.msSaveOrOpenBlob((void 0===(c=r)?c={autoBom:!1}:"object"!=typeof c&&(console.warn("Deprecated: Expected third argument to be a object"),c={autoBom:!c}),c.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob(["\uFEFF",e],{type:e.type}):e),n)}else if(s(e))t(e,n,r);else{var o=document.createElement("a");o.href=e,o.target="_blank",setTimeout(function(){a(o)})}}:function(e,n,s,a){if((a=a||open("","_blank"))&&(a.document.title=a.document.body.innerText="downloading..."),"string"==typeof e)return t(e,n,s);var o="application/octet-stream"===e.type,i=/constructor/i.test(r.HTMLElement)||r.safari,l=/CriOS\/[\d]+/.test(navigator.userAgent);if((l||o&&i||c)&&"undefined"!=typeof FileReader){var d=new FileReader;d.onloadend=function(){var e=d.result;e=l?e:e.replace(/^data:[^;]*;/,"data:attachment/file;"),a?a.location.href=e:location=e,a=null},d.readAsDataURL(e)}else{var h=r.URL||r.webkitURL,p=h.createObjectURL(e);a?a.location=p:location.href=p,a=null,setTimeout(function(){h.revokeObjectURL(p)},4e4)}});r.saveAs=o.saveAs=o,e.exports=o})?s.apply(t,[]):s)&&(e.exports=a)},2151:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/product/list",function(){return n(7474)}])},7474:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return h}});var s=n(5893),a=n(7294),r=n(1664),c=n.n(r),o=n(4105),i=n(8102);let l=new Intl.NumberFormat("th-TH"),d={active:"bg-success text-white",ใช้งาน:"bg-success text-white",inactive:"bg-danger text-white",ไม่ใช้งาน:"bg-danger text-white",pending:"bg-warning text-dark",รอดำเนินการ:"bg-warning text-dark"};function h(){let[e,t]=(0,a.useState)([]),[n,r]=(0,a.useState)(!0),[h,p]=(0,a.useState)(""),[u,x]=(0,a.useState)(!1),[m,f]=(0,a.useState)(!1),[b,g]=(0,a.useState)(!1),[j,_]=(0,a.useState)(!1);(0,a.useEffect)(()=>{fetch("/api/products").then(e=>e.json()).then(e=>t(e)).catch(()=>t([])).finally(()=>r(!1))},[]);let v=e.filter(e=>{var t;return null===(t=e.product_name)||void 0===t?void 0:t.toLowerCase().includes(h.toLowerCase())}).filter(e=>b?1===Number(e.is_shopee):!j||1===Number(e.is_lazada)),w=async n=>{confirm("คุณแน่ใจจะลบสินค้านี้หรือไม่?")&&(await fetch("/api/products?id=".concat(n),{method:"DELETE"}),t(e.filter(e=>e.product_id!==n)))};return n?(0,s.jsx)("div",{className:"min-vh-100 d-flex justify-content-center align-items-center text-primary fs-4 fw-semibold",children:"Loading..."}):(0,s.jsx)("div",{className:"min-vh-100 bg-light py-3",children:(0,s.jsx)("div",{className:"container-fluid px-2",children:(0,s.jsxs)("div",{className:"card shadow-lg",children:[(0,s.jsxs)("div",{className:"card-header bg-primary text-white d-flex align-items-center",children:[(0,s.jsx)("div",{className:"flex-grow-1 d-flex justify-content-center",children:(0,s.jsx)("h2",{className:"mb-0",children:"\uD83D\uDCE6 รายการสินค้า"})}),(0,s.jsx)(c(),{href:"/product/add",legacyBehavior:!0,children:(0,s.jsx)("a",{className:"btn btn-success",children:"➕ เพิ่มสินค้า"})})]}),(0,s.jsxs)("div",{className:"p-3",children:[(0,s.jsx)("div",{className:"row",children:(0,s.jsx)("div",{className:"col",children:(0,s.jsx)("input",{type:"text",className:"form-control",placeholder:"ค้นหาสินค้าตามชื่อ...",value:h,onChange:e=>p(e.target.value)})})}),(0,s.jsxs)("div",{className:"d-flex align-items-center mt-2",children:[(0,s.jsxs)("div",{className:"d-flex gap-3",children:[(0,s.jsxs)("div",{className:"form-check",children:[(0,s.jsx)("input",{className:"form-check-input",type:"checkbox",id:"shopeeFilter",checked:b,onChange:e=>{g(e.target.checked),e.target.checked&&_(!1)}}),(0,s.jsx)("label",{className:"form-check-label",htmlFor:"shopeeFilter",children:"เฉพาะ Shopee"})]}),(0,s.jsxs)("div",{className:"form-check",children:[(0,s.jsx)("input",{className:"form-check-input",type:"checkbox",id:"lazadaFilter",checked:j,onChange:e=>{_(e.target.checked),e.target.checked&&g(!1)}}),(0,s.jsx)("label",{className:"form-check-label",htmlFor:"lazadaFilter",children:"เฉพาะ Lazada"})]})]}),(0,s.jsx)("div",{className:"flex-grow-1"}),(0,s.jsxs)("div",{className:"d-flex gap-2",children:[(0,s.jsxs)("button",{className:"btn d-flex align-items-center",onClick:()=>{let e=v.filter(e=>1===Number(e.is_shopee)).map(e=>({รหัสสินค้า:e.product_id,ชื่อสินค้า:e.product_name,ประเภท:e.product_category_name,สี:e.color_name,Qty:e.qty,Stock:e.stock,ราคาซื้อ:e.purchase_price,lot:e.lot,"ค่าขนส่ง/ชิ้น":e.shipping_cost_piece,ต้นทุนรวม:e.total_cost_including_shipping,ขาย1:e.sell_price_1,ขาย2:e.sell_price_2,ขาย3:e.sell_price_3,สถานะ:e.product_status})),t=o.P6.json_to_sheet(e),n=o.P6.book_new();o.P6.book_append_sheet(n,t,"Shopee");let s=o.cW(n,{bookType:"xlsx",type:"array"});(0,i.saveAs)(new Blob([s]),"Shopee_รายการสินค้า.xlsx")},disabled:!b,onMouseEnter:()=>x(!0),onMouseLeave:()=>x(!1),style:{color:u?"white":"orange",backgroundColor:u?"orange":"transparent",border:"1px solid orange",opacity:b?1:.5,cursor:b?"pointer":"not-allowed"},children:[(0,s.jsx)("span",{style:{marginRight:6,fontSize:"1.2rem"},children:"\uD83D\uDCE5"}),"Export Shopee"]}),(0,s.jsxs)("button",{className:"btn d-flex align-items-center",onClick:()=>{let e=v.filter(e=>1===Number(e.is_lazada)).map(e=>({รหัสสินค้า:e.product_id,ชื่อสินค้า:e.product_name,ประเภท:e.product_category_name,สี:e.color_name,Qty:e.qty,Stock:e.stock,ราคาซื้อ:e.purchase_price,lot:e.lot,"ค่าขนส่ง/ชิ้น":e.shipping_cost_piece,ต้นทุนรวม:e.total_cost_including_shipping,ขาย1:e.sell_price_1,ขาย2:e.sell_price_2,ขาย3:e.sell_price_3,สถานะ:e.product_status})),t=o.P6.json_to_sheet(e),n=o.P6.book_new();o.P6.book_append_sheet(n,t,"Lazada");let s=o.cW(n,{bookType:"xlsx",type:"array"});(0,i.saveAs)(new Blob([s]),"Lazada_รายการสินค้า.xlsx")},disabled:!j,onMouseEnter:()=>f(!0),onMouseLeave:()=>f(!1),style:{color:m?"white":"blue",backgroundColor:m?"blue":"transparent",border:"1px solid blue",opacity:j?1:.5,cursor:j?"pointer":"not-allowed"},children:[(0,s.jsx)("span",{style:{marginRight:6,fontSize:"1.2rem"},children:"\uD83D\uDCE4"}),"Export Lazada"]})]})]})]}),(0,s.jsx)("div",{className:"card-body table-responsive p-2",children:(0,s.jsxs)("table",{className:"table table-striped table-hover align-middle text-center",children:[(0,s.jsx)("thead",{className:"table-dark",children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{children:"รหัสสินค้า"}),(0,s.jsx)("th",{children:"ชื่อสินค้า"}),(0,s.jsx)("th",{children:"ประเภท"}),(0,s.jsx)("th",{children:"สี"}),(0,s.jsx)("th",{children:"Qty"}),(0,s.jsx)("th",{children:"Stock"}),(0,s.jsx)("th",{children:"ราคาซื้อ"}),(0,s.jsx)("th",{children:"lot"}),(0,s.jsx)("th",{children:"ค่าขนส่ง/ชิ้น"}),(0,s.jsx)("th",{children:"ต้นทุนรวม"}),(0,s.jsx)("th",{children:"ขาย1"}),(0,s.jsx)("th",{children:"ขาย2"}),(0,s.jsx)("th",{children:"ขาย3"}),(0,s.jsx)("th",{children:"สถานะ"}),(0,s.jsx)("th",{children:"Shopee"}),(0,s.jsx)("th",{children:"Lazada"}),(0,s.jsx)("th",{children:"จัดการ"})]})}),(0,s.jsx)("tbody",{children:0===v.length?(0,s.jsx)("tr",{children:(0,s.jsx)("td",{colSpan:17,className:"text-center text-muted",children:"ไม่พบข้อมูลสินค้า"})}):v.map(e=>(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:e.product_id}),(0,s.jsx)("td",{children:e.product_name}),(0,s.jsx)("td",{children:e.product_category_name}),(0,s.jsx)("td",{children:e.color_name}),(0,s.jsx)("td",{children:l.format(e.qty)}),(0,s.jsx)("td",{children:l.format(e.stock)}),(0,s.jsx)("td",{children:l.format(e.purchase_price)}),(0,s.jsx)("td",{children:e.lot}),(0,s.jsx)("td",{children:l.format(e.shipping_cost_piece)}),(0,s.jsx)("td",{children:l.format(e.total_cost_including_shipping)}),(0,s.jsx)("td",{children:l.format(e.sell_price_1)}),(0,s.jsx)("td",{children:l.format(e.sell_price_2)}),(0,s.jsx)("td",{children:l.format(e.sell_price_3)}),(0,s.jsx)("td",{children:(0,s.jsx)("span",{className:"badge ".concat(d[e.product_status]||"bg-secondary"),children:e.product_status})}),(0,s.jsx)("td",{children:1===Number(e.is_shopee)?(0,s.jsx)("span",{className:"badge bg-warning text-dark",children:"ใช่"}):(0,s.jsx)("span",{className:"badge bg-secondary",children:"ไม่ใช่"})}),(0,s.jsx)("td",{children:1===Number(e.is_lazada)?(0,s.jsx)("span",{className:"badge bg-warning text-dark",children:"ใช่"}):(0,s.jsx)("span",{className:"badge bg-secondary",children:"ไม่ใช่"})}),(0,s.jsx)("td",{children:(0,s.jsxs)("div",{className:"d-flex gap-2 justify-content-center",children:[(0,s.jsx)(c(),{href:"/product/edit/".concat(e.product_id),legacyBehavior:!0,children:(0,s.jsx)("a",{className:"btn btn-sm btn-primary",children:"แก้ไข"})}),(0,s.jsx)("button",{className:"btn btn-sm btn-danger",onClick:()=>w(e.product_id),children:"ลบ"})]})})]},e.product_id))})]})})]})})})}},67:function(){},2061:function(){}},function(e){e.O(0,[251,664,774,888,179],function(){return e(e.s=2151)}),_N_E=e.O()}]);